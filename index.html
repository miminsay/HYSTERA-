<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<title>HYSTERA</title>

<style>
*{box-sizing:border-box}
body{
  margin:0;
  background:#f4f4f4;
  font-family: monospace;
  height:100vh;
  display:flex;
  flex-direction:column;
}

#title{
  text-align:center;
  padding:12px;
  background:#fff;
  letter-spacing:6px;
  font-size:22px;
}

#chat{
  flex:1;
  padding:15px;
  overflow-y:auto;
}

.msg{margin-bottom:10px}
.user{color:#000}
.bot{color:#444}
.system{color:#888;font-style:italic}

#inputBox{
  display:flex;
  border-top:1px solid #ccc;
}

input{
  flex:1;
  padding:12px;
  border:none;
  outline:none;
  font-size:16px;
}

button{
  background:#000;
  color:#fff;
  border:none;
  padding:12px;
}

.glitch{
  animation:glitch .12s infinite;
}

@keyframes glitch{
  0%{transform:translate(0)}
  25%{transform:translate(-1px,1px)}
  50%{transform:translate(1px,-1px)}
  75%{transform:translate(-1px,-1px)}
}
</style>
</head>

<body>

<div id="title">H Y S T E R A</div>
<div id="chat"></div>

<div id="inputBox">
  <input id="input" placeholder="digite..." autocomplete="off">
  <button id="send">ENVIAR</button>
</div>

<!-- ÁUDIOS -->
<audio id="ambience" src="ambience.mp3" loop></audio>
<audio id="heartbeat" src="heartbeat.mp3" loop></audio>
<audio id="whisper" src="whisper.mp3"></audio>

<script>
// ===== VARIÁVEIS =====
let steps = 0;
let lastUser = "";
let current = 0;

const chat = document.getElementById("chat");
const input = document.getElementById("input");
const send = document.getElementById("send");

const ambience = document.getElementById("ambience");
const heartbeat = document.getElementById("heartbeat");
const whisper = document.getElementById("whisper");

ambience.volume = 0.2;
heartbeat.volume = 0;
whisper.volume = 0.5;

// ===== PERSONAGENS =====
const girls = [
  {name:"Joy", role:"Mania"},
  {name:"Seulgi", role:"Depressão"},
  {name:"Irene", role:"Obsessão"},
  {name:"Yeri", role:"Paranoia"}
];

// ===== FUNÇÕES =====
function add(text, cls){
  const d = document.createElement("div");
  d.className = "msg " + cls;
  d.innerText = text;
  chat.appendChild(d);
  chat.scrollTop = chat.scrollHeight;
}

function rand(max){ return Math.floor(Math.random()*max); }

// ===== RESPOSTA HUMANA INSANA =====
function smartReply(userText){
  const g = girls[current];
  const lower = userText.toLowerCase();

  const risadas = ["kkkk","klkkkk","KSKSKS","mds kkk","KKKK"];
  const fillers = ["mano","vei","tipo","sei lá","mds","slc"];
  const reacoes = ["oxi","ué","aham","entendi","talvez"];

  let r = "";

  // base humana
  if(lower.includes("oi")) r += "oiii ";
  else if(lower.includes("?")) r += reacoes[rand(reacoes.length)] + ", ";
  else r += fillers[rand(fillers.length)] + ", ";

  // ===== PERSONALIDADES =====
  if(g.name==="Joy"){
    r += "eu falo demais né kkk ";
    if(Math.random()>0.5) r += risadas[rand(risadas.length)]+" ";
    if(steps>10) r += "minha cabeça não desliga. ";
  }

  if(g.name==="Seulgi"){
    r += "to meio cansada hoje. ";
    if(Math.random()>0.6) r += "mas pode falar. ";
    if(steps>15) r += "tudo pesa aqui. ";
  }

  if(g.name==="Irene"){
    if(lower.includes("vc")) r += "vc escreveu vc. ";
    r += "isso já apareceu antes. ";
    if(steps>12) r += "estamos em loop. ";
  }

  if(g.name==="Yeri"){
    r += "hm. ";
    if(Math.random()>0.6) r += "estranho. ";
    // paranoia controlada, sem insanidade extra
  }

  // ===== CONTEÚDO =====
  if(lower.includes("jogo")) r += "ninguém chamou isso de jogo. ";
  if(lower.includes("real")) r += "real demais. ";
  if(lower.includes("medo")) r += "normal sentir isso aqui. ";

  // ===== DEGRADAÇÃO =====
  if(steps>18 && Math.random()>0.6)
    r += "acho q isso já aconteceu. ";

  if(steps>25)
    r += "a clínica registra tudo. ";

  return r;
}

// ===== RESPOSTA =====
function reply(){
  const g = girls[current];
  const text = smartReply(lastUser);
  add(g.name + ": " + text, "bot");

  if(steps>6){
    heartbeat.volume = Math.min(0.6, steps*0.02);
    heartbeat.play();
  }

  if(g.name==="Yeri" && Math.random()>0.7){
    whisper.currentTime=0;
    whisper.play();
  }

  if(steps>14) document.body.classList.add("glitch");

  steps++;
  current = (current+1)%girls.length;
}

// ===== EVENTO =====
send.onclick = ()=>{
  ambience.play();
  if(!input.value) return;
  lastUser = input.value;
  add("Você: "+input.value,"user");
  input.value="";
  reply();
};

// ===== INTRO =====
add("Sistema: Clínica iniciada.","system");
add("Sistema: Pacientes conectadas.","system");
add("Sistema: Nenhum nome encontrado.","system");
</script>

</body>
</html>

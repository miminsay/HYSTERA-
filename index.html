<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>HYSTERA</title>

<style>
@import url('https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap');

body {
  margin: 0;
  background: #050505;
  color: #e6e6e6;
  font-family: 'Share Tech Mono', monospace;
  height: 100vh;
  display: flex;
  justify-content: center;
  align-items: center;
}

#game {
  width: 95%;
  max-width: 450px;
  height: 92vh;
  background: #0a0a0a;
  border: 1px solid #333;
  display: flex;
  flex-direction: column;
  position: relative;
}

header {
  padding: 10px;
  border-bottom: 1px solid #333;
  text-align: center;
  letter-spacing: 4px;
}

#status {
  font-size: 11px;
  opacity: 0.6;
}

#chat {
  flex: 1;
  padding: 10px;
  overflow-y: auto;
  font-size: 13px;
}

.msg {
  margin-bottom: 8px;
}

.bot {
  color: #9aaaff;
}

.user {
  text-align: right;
}

.entity {
  font-size: 11px;
  opacity: 0.7;
}

#inputArea {
  display: flex;
  border-top: 1px solid #333;
}

input {
  flex: 1;
  background: #000;
  border: none;
  color: #fff;
  padding: 10px;
  font-family: inherit;
}

button {
  background: #111;
  border: none;
  color: #fff;
  padding: 10px 15px;
}

.glitch {
  animation: glitch 0.2s infinite;
}

@keyframes glitch {
  0% { transform: translate(0); }
  25% { transform: translate(-2px, 1px); }
  50% { transform: translate(2px, -1px); }
  75% { transform: translate(-1px, -2px); }
  100% { transform: translate(0); }
}

.secret {
  color: #b30000;
  font-size: 12px;
  margin-top: 10px;
}
</style>
</head>

<body>

<audio id="music" src="music.mp3" loop></audio>
<audio id="whisper" src="whisper.mp3" loop></audio>
<audio id="heart" src="heart.mp3" loop></audio>
<audio id="breath" src="breath.mp3" loop></audio>

<div id="game">
  <header>
    <div>HYSTERA</div>
    <div id="status">PROTOCOLO DE OBSERVAÇÃO ATIVO</div>
  </header>

  <div id="chat"></div>

  <div id="inputArea">
    <input id="input" placeholder="Digite sua resposta..." />
    <button onclick="send()">➤</button>
  </div>
</div>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");
const status = document.getElementById("status");

const music = document.getElementById("music");
const whisper = document.getElementById("whisper");
const heart = document.getElementById("heart");
const breath = document.getElementById("breath");

let clicks = 0;
let secrets = 0;
let current = 0;

const entities = [
  {
    name: "Irene",
    role: "Obsessão",
    desc: "Rosto negro. Postura perfeita. Controle absoluto.",
    replies: [
      "Leia sua frase de novo.",
      "Algo ainda não está correto.",
      "A ordem mantém você seguro.",
      "Repita."
    ],
    sound: whisper
  },
  {
    name: "Joy",
    role: "Mania",
    desc: "Rosto negro. Movimento constante. Energia sem pausa.",
    replies: [
      "RÁPIDO! Continua!",
      "Isso é incrível, não acha?",
      "Vamos falar de outra coisa!",
      "Você está acompanhando?"
    ],
    sound: heart
  },
  {
    name: "Seulgi",
    role: "Depressão",
    desc: "Rosto negro. Corpo humano, presença silenciosa.",
    replies: [
      "Estou aqui.",
      "Sem pressa.",
      "Pode continuar.",
      "Entendo."
    ],
    sound: breath
  },
  {
    name: "Yeri",
    role: "Paranoia",
    desc: "Rosto negro. Olhar que nunca fixa.",
    replies: [
      "Você percebeu a interface mudar?",
      "Nem tudo responde como deveria.",
      "Você confia nisso?",
      "Algo observa."
    ],
    sound: whisper,
    paranoia: true
  }
];

function addMsg(text, cls) {
  const div = document.createElement("div");
  div.className = "msg " + cls;
  div.innerText = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function send() {
  if (!input.value.trim()) return;

  if (music.paused) music.play();

  addMsg(input.value, "user");
  input.value = "";
  clicks++;

  if (clicks === 7 || clicks === 14) {
    secrets++;
    addMsg("ARQUIVO SECRETO DESBLOQUEADO: Paciente demonstra adaptação ao ambiente.", "secret");
  }

  setTimeout(reply, 600);
}

function reply() {
  const e = entities[current];

  entities.forEach(ent => ent.sound.pause());
  e.sound.play();

  if (e.paranoia) {
    document.body.classList.add("glitch");
    if (navigator.vibrate) navigator.vibrate([200,100,200]);
    setTimeout(()=>document.body.classList.remove("glitch"), 1200);
  }

  const msg = e.replies[Math.floor(Math.random()*e.replies.length)];
  addMsg(`${e.name} (${e.role}): ${msg}`, "bot");
  addMsg(`⦿ ${e.desc}`, "entity");

  current = (current + 1) % entities.length;

  if (clicks > 20) endGame();
}

function endGame() {
  status.innerText = "AVALIAÇÃO ENCERRADA";
  addMsg(
    secrets >= 2
      ? "RESULTADO: Você reconheceu os padrões. Alta concedida."
      : "RESULTADO: Você apenas respondeu. Observação contínua.",
    "bot"
  );
}
</script>
</body>
</html>

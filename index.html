<!DOCTYPE html>
<html lang="pt-br">
<head>
<meta charset="UTF-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0"/>
<title>HYSTERA</title>
<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
<style>
:root{
  --bg:#07070a; --panel:#0c0c12; --line:#2a2a33; --txt:#e8e8ee; --bot:#9aaaff;
}
*{box-sizing:border-box}
body{
  margin:0; background:radial-gradient(1200px 800px at 50% 20%, #0b0b14, var(--bg));
  color:var(--txt); font-family:'Share Tech Mono', monospace; height:100vh;
  display:flex; align-items:center; justify-content:center; overflow:hidden;
}
#app{
  width:95%; max-width:460px; height:92vh; background:linear-gradient(180deg,#0f0f18,#090912);
  border:1px solid var(--line); display:flex; flex-direction:column; position:relative;
}
header{
  padding:10px 12px; border-bottom:1px solid var(--line); text-align:center; letter-spacing:4px;
}
#status{font-size:11px; opacity:.65}
#chat{
  flex:1; padding:12px; overflow-y:auto; font-size:13px;
}
.msg{margin:8px 0; line-height:1.35}
.user{text-align:right}
.bot{color:var(--bot)}
.system{color:#8b8b96; font-size:11px}
.meta{color:#b3b3be; font-size:11px; opacity:.8}
#inputArea{
  display:flex; border-top:1px solid var(--line);
}
input{
  flex:1; background:#000; border:none; color:#fff; padding:12px; font-family:inherit;
}
button{
  background:#12121a; border:none; color:#fff; padding:0 16px; cursor:pointer;
}
button:hover{background:#181826}
.glitch{animation:gl 0.15s infinite}
@keyframes gl{
  0%{transform:translate(0)} 50%{transform:translate(-1px,1px)} 100%{transform:translate(0)}
}
.scan{position:absolute; inset:0; pointer-events:none; background:
linear-gradient(transparent 95%, rgba(255,255,255,.04) 96%);}
.fade{opacity:.85}
</style>
</head>

<body>
<audio id="music" src="music.mp3" loop></audio>
<audio id="whisper" src="whisper.mp3"></audio>
<audio id="heart" src="heart.mp3" loop></audio>
<audio id="glitchSound" src="glitch.mp3"></audio>

<div id="app">
  <div class="scan"></div>
  <header>
    <div>HYSTERA</div>
    <div id="status">clínica branca • chat online</div>
  </header>

  <div id="chat"></div>

  <div id="inputArea">
    <input id="input" placeholder="digite uma mensagem..." />
    <button id="send">➤</button>
  </div>
</div>

<script>
const chat = document.getElementById('chat');
const input = document.getElementById('input');
const sendBtn = document.getElementById('send');
const statusEl = document.getElementById('status');

const music = document.getElementById('music');
const whisper = document.getElementById('whisper');
const heart = document.getElementById('heart');
const glitchSound = document.getElementById('glitchSound');

let steps=0, paranoia=0, acceptance=0;
let current=0, silenceTimer=null;

// ---- ENTIDADES (humanas, online, labirinto) ----
const girls=[
 {name:'Joy', role:'Mania',
  normal:['oiii','vc acordou agora?','kkk esse lugar é silencioso né'],
  shift:['fala rápido','não para','continua comigo'],
  meta:['o corredor corre','o tempo acelera aqui']},
 {name:'Seulgi', role:'Depressão',
  normal:['oi','tá tudo branco hoje','pode falar'],
  shift:['o som fica longe','o tempo pesa','tô aqui'],
  meta:['a luz cansa','o eco fica grande']},
 {name:'Irene', role:'Obsessão',
  normal:['oi','vc escreveu certo?','repete pra eu ver'],
  shift:['quase certo','revê de novo','tem algo fora do lugar'],
  meta:['isso já aconteceu','é um ciclo']},
 {name:'Yeri', role:'Paranoia',
  normal:['oi','vc ouviu isso?','acho que travou'],
  shift:['a interface piscou','alguém leu isso','não era pra aparecer'],
  meta:['a clínica escuta','não é um lugar']}
];

function add(text, cls='bot'){
  const d=document.createElement('div');
  d.className='msg '+cls; d.textContent=text;
  chat.appendChild(d); chat.scrollTop=chat.scrollHeight;
}

function system(text){ add(text,'system'); }

function pulse(){
  document.body.classList.add('glitch');
  glitchSound.currentTime=0; glitchSound.play();
  if(navigator.vibrate) navigator.vibrate(120);
  setTimeout(()=>document.body.classList.remove('glitch'),600);
}

function reply(){
  const g=girls[current];
  let msg;
  if(steps<6) msg = g.normal[rand(g.normal.length)];
  else if(steps<14) msg = g.shift[rand(g.shift.length)];
  else msg = g.meta[rand(g.meta.length)];

  add(`${g.name}: ${msg}`,'bot');

  // áudio & sensação
  if(steps===4){ whisper.play(); music.volume=.35; music.play(); }
  if(steps===8){ heart.volume=.4; heart.play(); }
  if(steps>=12){ paranoia++; pulse(); statusEl.textContent='clínica branca • corredores se dobram'; }

  // aceitação vs perda
  if(/entendo|ok|tudo bem|aceito|calma/i.test(lastUser||'')) acceptance++;

  current=(current+1)%girls.length;
}

let lastUser='';
function send(){
  if(!input.value.trim()) return;
  if(music.paused) music.play();
  lastUser=input.value;
  add(input.value,'user');
  input.value=''; steps++;
  clearTimeout(silenceTimer);
  silenceTimer=setTimeout(()=>system('…'),900+Math.random()*800);
  setTimeout(reply,700+Math.random()*900);
  if(steps===10) system('Prontuários reaparecem.');
  if(steps===18) endCheck();
}

function endCheck(){
  system('Avaliação em curso.');
  setTimeout(()=>{
    if(acceptance>=3){
      system('Resultado: aceitação.');
      add('Joy: fica.','bot');
      add('Seulgi: eu fico.','bot');
      add('Irene: agora fecha.','bot');
      add('Yeri: você percebeu.','bot');
      statusEl.textContent='a clínica se aquieta';
    }else{
      system('Resultado: desaparecimento.');
      add('Yeri: alguém saiu.','bot');
      add('Seulgi: o silêncio cresce.','bot');
      statusEl.textContent='o labirinto continua';
    }
  },1200);
}

function rand(n){ return Math.floor(Math.random()*n); }

// inicial
system('Conectado. Você acordou na clínica branca.');
add('Joy: oi','bot');

sendBtn.onclick=send;
input.addEventListener('keydown',e=>{ if(e.key==='Enter') send(); });
</script>
</body>
</html>

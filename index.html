<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");

const base = {
  conectores: [
    "tipo", "real", "na moral", "ent√£o", "assim",
    "sei l√°", "sinceramente", "n√£o vou mentir",
    "falando s√©rio", "papo reto"
  ],
  reacoes: [
    "entendi", "peguei a vis√£o", "faz sentido",
    "isso bateu", "isso foi espec√≠fico",
    "deu pra sentir daqui", "isso diz muita coisa"
  ],
  perguntas: [
    "o que tu sentiu nisso?",
    "isso ficou na tua cabe√ßa depois?",
    "tu j√° tinha pensado nisso antes?",
    "isso te incomodou ou s√≥ passou?",
    "quer falar mais disso?"
  ],
  memes: [
    "eu rindo mas por dentro ü§°",
    "n√£o √© surto, √© viv√™ncia",
    "era dentro infelizmente",
    "mente indo de base",
    "isso foi muito floptok",
    "se n√£o rir a gente chora"
  ]
};

const personagens = {
  Seulgi(text){
    return montarResposta({
      tom: "sensivel",
      incluirPergunta: true,
      peso: 0.2
    });
  },
  Joy(text){
    return montarResposta({
      tom: "leve",
      incluirMeme: true,
      peso: 0.5
    });
  },
  Irene(text){
    return montarResposta({
      tom: "organizado",
      incluirPergunta: false,
      peso: 0.1
    });
  },
  Yeri(text){
    return montarResposta({
      tom: "observador",
      incluirPergunta: true,
      peso: 0.3
    });
  }
};

function rand(arr){
  return arr[Math.floor(Math.random() * arr.length)];
}

function montarResposta(opts){
  let frase = "";

  if(Math.random() < 0.7){
    frase += rand(base.conectores) + ", ";
  }

  frase += rand(base.reacoes);

  if(opts.incluirPergunta && Math.random() < 0.6){
    frase += ". " + rand(base.perguntas);
  }

  if(opts.incluirMeme && Math.random() < opts.peso){
    frase += " ‚Äî " + rand(base.memes);
  }

  return frase;
}

function escolherPersonagem(){
  const nomes = Object.keys(personagens);
  return nomes[Math.floor(Math.random() * nomes.length)];
}

function addMessage(text, className){
  const div = document.createElement("div");
  div.className = "msg " + className;
  div.innerText = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function sendMessage(){
  const text = input.value.trim();
  if(!text) return;

  addMessage("Voc√™: " + text, "user");
  input.value = "";

  const nome = escolherPersonagem();
  const resposta = personagens[nome](text);

  setTimeout(()=>{
    addMessage(`${nome}: ${resposta}`, "bot");
  }, 500 + Math.random()*900);
}

input.addEventListener("keydown", e=>{
  if(e.key === "Enter") sendMessage();
});

setTimeout(()=>{
  addMessage("Sistema: sess√£o ativa. conversa sem fim.", "system");
}, 600);
</script>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");

const personagens = [
  {
    nome: "Seulgi",
    peso: "baixo",
    falas: [
      "eu entendi o que tu quis dizer",
      "isso soa cansativo… de um jeito real",
      "não precisa fingir força aqui",
      "fala comigo, eu acompanho teu ritmo",
      "isso ficou pesado, mas eu tô aqui"
    ]
  },
  {
    nome: "Joy",
    peso: "medio",
    falas: [
      "KKKK eu ri mas foi de nervoso",
      "amg isso doeu um pouquinho",
      "ok… isso ficou sério rápido",
      "tem coisa que a gente brinca pra não quebrar",
      "não vou zoar isso não, pode continuar"
    ]
  },
  {
    nome: "Irene",
    peso: "alto",
    falas: [
      "faz sentido o que tu disse",
      "vamos por partes, sem atropelar",
      "isso não é exagero, é atenção",
      "continua, não corta agora",
      "tô acompanhando cada detalhe"
    ]
  },
  {
    nome: "Yeri",
    peso: "medio",
    falas: [
      "ok… me explica melhor isso",
      "tem algo aí que chama atenção",
      "isso te deixou desconfortável depois?",
      "não parece aleatório",
      "continua, quero entender"
    ]
  }
];

function addMessage(text, className){
  const div = document.createElement("div");
  div.className = "msg " + className;
  div.innerText = text;
  chat.appendChild(div);
  chat.scrollTop = chat.scrollHeight;
}

function analisarTom(text){
  if(text.match(/kkk|lol|mds|aff/i)) return "leve";
  if(text.length > 80) return "pesado";
  if(text.includes("?")) return "reflexivo";
  return "neutro";
}

function botReply(userText){
  const tom = analisarTom(userText);

  let filtrados = personagens;

  if(tom === "pesado"){
    filtrados = personagens.filter(p => p.nome !== "Joy");
  }

  const p = filtrados[Math.floor(Math.random() * filtrados.length)];
  let resposta = p.falas[Math.floor(Math.random() * p.falas.length)];

  if(tom === "reflexivo"){
    resposta += " — o que isso significa pra você?";
  }

  if(tom === "leve" && p.nome === "Joy"){
    resposta += " kkkkk";
  }

  setTimeout(()=>{
    addMessage(`${p.nome}: ${resposta}`, "bot");
  }, 600 + Math.random()*600);
}

function sendMessage(){
  const text = input.value.trim();
  if(!text) return;

  addMessage("Você: " + text, "user");
  input.value = "";

  botReply(text);
}

input.addEventListener("keydown", e=>{
  if(e.key === "Enter") sendMessage();
});

setTimeout(()=>{
  addMessage("Sistema: sessão iniciada. você não será ignorado.", "system");
}, 700);
  </script>

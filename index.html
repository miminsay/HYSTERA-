<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<title>HYSTERA</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
*{ box-sizing:border-box; font-family:monospace; }

body{
  margin:0;
  background:#000;
  color:#fff;
  height:100vh;
  display:flex;
  flex-direction:column;
}

header{
  padding:16px;
  text-align:center;
  font-size:1.7rem;
  letter-spacing:3px;
  border-bottom:1px solid #222;
}

#chat{
  flex:1;
  padding:20px;
  overflow-y:auto;
  display:flex;
  flex-direction:column;
  gap:14px;
  font-size:1.15rem;
}

.msg{
  max-width:85%;
  padding:14px 18px;
  border-radius:12px;
}

.user{
  align-self:flex-end;
  background:#111;
  border:1px solid #333;
}

.bot{
  align-self:flex-start;
  background:#050505;
  border:1px solid #222;
  color:#bbb;
}

.system{
  align-self:center;
  font-size:.9rem;
  color:#666;
}

footer{
  display:flex;
  gap:10px;
  padding:16px;
  border-top:1px solid #222;
}

input{
  flex:1;
  padding:16px;
  font-size:1.1rem;
  background:#0a0a0a;
  border:1px solid #333;
  color:#fff;
  border-radius:10px;
  outline:none;
}

button{
  padding:16px 22px;
  font-size:1.1rem;
  background:#8b0000;
  border:none;
  color:#fff;
  border-radius:10px;
  cursor:pointer;
}

button:hover{ background:#b00000; }
</style>
</head>

<body>

<header>HYSTERA</header>

<div id="chat"></div>

<footer>
  <input id="input" placeholder="fala alguma coisa…" />
  <button onclick="sendMessage()">Enviar</button>
</footer>

<script>
const chat = document.getElementById("chat");
const input = document.getElementById("input");

let ultimaResposta = "";

const personagens = [
  { nome:"Seulgi", vibe:"depressao" },
  { nome:"Joy", vibe:"mania" },
  { nome:"Yeri", vibe:"paranoia" },
  { nome:"Irene", vibe:"obsessao" }
];

const girias = [
  "mano","véi","mds","real","juro",
  "KKKK","????","rindo de nervoso","socorro"
];

const falasBase = {
  depressao:[
    "isso pesa real.",
    "cansa até existir.",
    "não é drama não.",
    "tô aqui ouvindo."
  ],
  mania:[
    "KKKK eu ri foi mal.",
    "isso deu um gás estranho.",
    "minha cabeça acelerou.",
    "fala mais, rápido."
  ],
  paranoia:[
    "isso não parece coincidência.",
    "tem algo estranho aí.",
    "fica atento.",
    "não ignora isso."
  ],
  obsessao:[
    "volta nisso.",
    "tem detalhe faltando.",
    "organiza melhor.",
    "isso não fechou."
  ]
};

const gatilhos = {
  medo:"quando tu fala medo, teu corpo já tá em alerta.",
  cansado:"isso soa como exaustão de verdade.",
  sozinho:"ficar sozinho aqui nunca é só ficar sozinho.",
  ouvir:"tu ouviu isso mesmo… ou só pareceu?",
  ver:"nem tudo que a gente vê é confiável."
};

function rand(arr){
  return arr[Math.floor(Math.random()*arr.length)];
}

function addMessage(text,type){
  const div=document.createElement("div");
  div.className="msg "+type;
  div.innerText=text;
  chat.appendChild(div);
  chat.scrollTop=chat.scrollHeight;
}

function extrairTrecho(text){
  const palavras=text.split(" ");
  if(palavras.length<=4) return text;
  return palavras.slice(0,4).join(" ");
}

function respostaContextual(p,userText){
  const inicio = rand(girias);
  const trecho = extrairTrecho(userText.toLowerCase());

  // gatilhos diretos
  for(let g in gatilhos){
    if(userText.toLowerCase().includes(g)){
      return `${inicio}… ${gatilhos[g]} (olhando pra você)`;
    }
  }

  // pergunta direta
  if(userText.includes("?")){
    return `${inicio}… quando tu pergunta "${trecho}…", o que tu espera ouvir?`;
  }

  // curta demais
  if(userText.length < 4){
    return `${inicio}… fala direito comigo.`;
  }

  // resposta base + eco
  const base = rand(falasBase[p.vibe]);
  return `${inicio}… tu disse "${trecho}…" — ${base}`;
}

function botReply(userText){
  const p = rand(personagens);
  let resposta;

  do{
    resposta = respostaContextual(p,userText);
  }while(resposta === ultimaResposta);

  ultimaResposta = resposta;

  setTimeout(()=>{
    addMessage(`${p.nome}: ${resposta}`, "bot");
  },400 + Math.random()*600);
}

function sendMessage(){
  const text = input.value.trim();
  if(!text) return;

  addMessage("Você: " + text, "user");
  input.value="";
  botReply(text);
}

input.addEventListener("keydown",e=>{
  if(e.key==="Enter") sendMessage();
});

setTimeout(()=>{
  addMessage("Sistema: paciente conectado. a clínica nunca foi um lugar.", "system");
},600);
</script>

</body>
  </html>
